version: "3.1"

rules:
# Greet the user
- rule: Greet user
  steps:
    - intent: greet
    - action: utter_greet

# Say goodbye to the user
- rule: Say goodbye
  steps:
    - intent: goodbye
    - action: utter_goodbye

# Respond with bot capabilities
- rule: Tell user capabilities
  steps:
    - intent: ask_capability
    - action: utter_ask_capability

# Handle fallback (low confidence or unclear queries)
- rule: Default fallback
  steps:
    - intent: nlu_fallback
    - action: utter_default

# Handle out-of-scope queries
- rule: Out of scope query
  steps:
    - intent: out_of_scope
    - action: utter_out_of_scope

# Activate song recommendation form
- rule: Activate song recommendation form
  steps:
    - intent: ask_similar_songs
    - action: song_recommendation_form
    - active_loop: song_recommendation_form

# Submit the form and trigger custom action
- rule: Submit song recommendation form
  condition:
    - active_loop: song_recommendation_form
  steps:
    - action: song_recommendation_form
    - active_loop: null
    - action: action_list_similar_songs
